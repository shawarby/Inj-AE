- hosts: all
  tasks:
  - name: Getting VMWARE UUID
    vmware_guest_info:
      validate_certs: no
      hostname: 192.168.0.249
      username: administrator@vsphere.local
      password:  P@ssw0rd
      validate_certs: no
      datacenter: datacenter
      name: testvm
      schema: "vsphere"
      properties:
    register: vminfo
    delegate_to: localhost
  - debug:
      var: vminfo.instance.config.uuid
    register: vm_uuid
  - name: Rename virtual machine from old name to new name
    vmware_guest:
      hostname: 192.168.0.249
      username: administrator@vsphere.local
      password:  P@ssw0rd
      validate_certs: False
      cluster: ClusterA
      uuid: "{{ vm_uuid }}"
      name: ttttt

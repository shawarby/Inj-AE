---
  - hosts: localhost
    gather_facts: no
    connection: localhost
    tasks:
      - name: Read Regions from CSV file and return ID
        read_csv:
          path: regions.csv
          key: region
        register: regions
      - name: Set Facts
        set_fact:
          region_name: '{{ regions.dict[region].region }}'
          region_id: '{{ regions.dict[region].region_id }}'

      - name: Read Tenants from CSV file and return ID
        read_csv:
          path: tenant.csv
          key: tenant_name
        register: tenants
      - name: Set Facts
        set_fact:
          tenant_name: '{{ tenants.dict[tenant].tenant_name }}'
          tenant_id: '{{ tenants.dict[tenant].tenant_id }}'


      - name: Set VM Name
        set_fact:
          vm_name: "{{ region_id }}{{ tenant_id }}"
